# アンケートダッシュボード＋Q&A テンプレート

Googleフォームのアンケート結果を自動集計するダッシュボードと、質問回答集（Q&A）のWebアプリを一発で構築できるテンプレート。

## できること

- 満足度・理解度などの指標をリアルタイムでダッシュボード表示
- セッション（ウェビナー回）ごとの経過比較チャート
- 会員区分 x 満足度のクロス集計
- 受講者の声（自由記述）のネガティブ検出
- Q&A質問回答集のWebアプリ
- フォーム送信時に自動でQ&Aシートに質問を取り込み

## セットアップ手順

### 1. Googleスプレッドシートを準備
- 新規スプレッドシートを作成
- Googleフォームを作成して紐付け（フォーム > 回答 > スプレッドシートにリンク）
- フォームに含めるとよい質問項目:
  - 満足度（5段階評価）
  - 理解度（選択式）
  - 感想・印象（自由記述）
  - 質問（自由記述）
  - 会員区分（任意）
  - アウトプット状況（任意）

### 2. スクリプトIDを取得
- スプレッドシート > 拡張機能 > Apps Script
- プロジェクトの設定（歯車アイコン）> スクリプトIDをコピー

### 3. テンプレートをpush
```bash
cd survey-dashboard-template/src

# .clasp.json を作成
cat > .clasp.json << EOF
{
  "scriptId": "ここにスクリプトIDを貼る",
  "rootDir": "."
}
EOF

# push
clasp push --force
```

### 4. 初期セットアップを実行
- スプレッドシートに戻ってページをリロード
- メニュー「アンケート管理」>「初期セットアップ」
- フォーム回答シートが自動検出される
- プロジェクト名とテーマカラーを入力
- Q&Aシートが自動作成される

### 5. WebAppをデプロイ
- Apps Script エディタ > デプロイ > 新しいデプロイ
- 種類: ウェブアプリ
- 実行ユーザー: 自分
- アクセス: 全員（またはドメイン内）
- デプロイ後のURLをコピー

### 6. WEB_APP_URL を設定
- Apps Script > プロジェクトの設定 > スクリプトプロパティ
- `WEB_APP_URL` にデプロイURLを設定

### 7. onFormSubmit トリガーを設定
- Apps Script > トリガー（時計アイコン）> トリガーを追加
- 関数: `onFormSubmit`
- イベント: フォーム送信時

## 使い方

| URL | 内容 |
|-----|------|
| `デプロイURL` | Q&A質問回答集（受講者向け） |
| `デプロイURL?page=dashboard` | アンケートダッシュボード（管理者向け） |

## ファイル構成

| ファイル | 役割 |
|---------|------|
| Config.gs | 設定の読み書きユーティリティ |
| Setup.gs | 初期セットアップ（ヘッダー自動検出） |
| Code.gs | メニュー、フォーム取り込み、onFormSubmit |
| SurveyAggregate.gs | ダッシュボード用データAPI |
| WebApp.gs | Webアプリルーティング、Q&AデータAPI |
| dashboard.html | ダッシュボード画面 |
| index.html | Q&A質問回答集画面 |
| guide.html | セットアップガイド画面 |
| colorpicker.html | テーマカラー選択ダイアログ |

## ヘッダー自動検出キーワード

セットアップ時にフォーム回答シートのヘッダーから以下のキーワードを検索して列を自動マッピングします:

| 項目 | 検索キーワード |
|------|---------------|
| タイムスタンプ | タイムスタンプ, timestamp |
| メール | メール, email, mail |
| 会員区分 | 会員, 区分, 所属, メンバー |
| セッション | ウェビナー, 回, セッション, 講座 |
| 満足度 | 満足度, 満足 |
| 理解度 | 理解度, 理解 |
| 感想 | 印象, 感想, 学び |
| アクション | やること, アクション, 実践 |
| アウトプット | アウトプット, 実行, 成果物 |
| 質問 | 質問, question |

マッチしなかった列は「自由記述」として受講者の声タブに自動表示されます。

## カラープリセット

| 選択肢 | プライマリカラー |
|--------|-----------------|
| 1. ピンク | #F490A1 |
| 2. ブルー | #4A90D9 |
| 3. グリーン | #27AE60 |
| 4. オレンジ | #F39C12 |
| 5. SHIFT AI | #ff5757 → #8c52ff |
