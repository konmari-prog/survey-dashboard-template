<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Noto Sans JP',sans-serif;background:#F8FAFB;padding:24px 20px}

h2{font-size:15px;font-weight:700;color:#2D3436;text-align:center;margin-bottom:20px}

.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}

.card{
  border:2px solid #E8ECEF;
  border-radius:12px;
  padding:14px;
  cursor:pointer;
  transition:all .15s ease;
  background:#fff;
  text-align:center;
}
.card:hover{
  border-color:#B0BEC5;
  transform:translateY(-1px);
  box-shadow:0 4px 12px rgba(0,0,0,.08);
}
.card:active{
  transform:translateY(0);
}

.swatch{
  width:100%;
  height:40px;
  border-radius:8px;
  margin-bottom:10px;
}

.label{
  font-size:13px;
  font-weight:700;
  color:#2D3436;
  margin-bottom:2px;
}
.hex{
  font-size:10px;
  color:#999;
  font-family:monospace;
}

/* SHIFT AI は横幅フルで目立たせる */
.card.full{
  grid-column:1 / -1;
}
</style>
</head>
<body>

<h2>テーマカラーを選択</h2>

<div class="grid">
  <div class="card" onclick="pick('pink')">
    <div class="swatch" style="background:linear-gradient(135deg,#F490A1,#E87A8E)"></div>
    <div class="label">ピンク</div>
    <div class="hex">#F490A1</div>
  </div>

  <div class="card" onclick="pick('blue')">
    <div class="swatch" style="background:linear-gradient(135deg,#4A90D9,#357ABD)"></div>
    <div class="label">ブルー</div>
    <div class="hex">#4A90D9</div>
  </div>

  <div class="card" onclick="pick('green')">
    <div class="swatch" style="background:linear-gradient(135deg,#27AE60,#1E8449)"></div>
    <div class="label">グリーン</div>
    <div class="hex">#27AE60</div>
  </div>

  <div class="card" onclick="pick('orange')">
    <div class="swatch" style="background:linear-gradient(135deg,#F39C12,#E67E22)"></div>
    <div class="label">オレンジ</div>
    <div class="hex">#F39C12</div>
  </div>

  <div class="card full" onclick="pick('shiftai')">
    <div class="swatch" style="background:linear-gradient(135deg,#ff5757,#8c52ff)"></div>
    <div class="label">SHIFT AI</div>
    <div class="hex">#ff5757 → #8c52ff</div>
  </div>
</div>

<div id="done" style="display:none;text-align:center;padding:40px 20px;">
  <div style="font-size:32px;margin-bottom:12px;">&#10003;</div>
  <div style="font-size:15px;font-weight:700;color:#2D3436;margin-bottom:8px;">設定を保存しました</div>
  <div style="font-size:12px;color:#888;">まもなく閉じます…</div>
</div>

<script>
function pick(key) {
  // カードを無効化して二重クリック防止
  document.querySelectorAll('.card').forEach(function(c){ c.style.pointerEvents='none'; c.style.opacity='0.5'; });

  google.script.run
    .withSuccessHandler(function(){
      document.querySelector('.grid').style.display = 'none';
      document.querySelector('h2').style.display = 'none';
      document.getElementById('done').style.display = 'block';
      setTimeout(function(){ google.script.host.close(); }, 1500);
    })
    .withFailureHandler(function(err){
      document.querySelectorAll('.card').forEach(function(c){ c.style.pointerEvents='auto'; c.style.opacity='1'; });
      alert('エラー: ' + err.message);
    })
    .receiveColorChoice(key);
}
</script>
</body>
</html>
